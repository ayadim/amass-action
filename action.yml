name: "amass"
description: "The OWASP Amass Project performs network mapping of attack surfaces and external asset discovery using open source information gathering and active reconnaissance techniques"
branding:
  icon: "activity"
  color: "blue"

inputs:

  domain:
    description: "domain to enumerate"
    required: false   

  config:
    description: "Path to the INI configuration file."
    required: false      

  brute:
    description: "Execute brute forcing after searches"
    required: false
    default: false  

  src:
    description: "Print data sources for the discovered names"
    required: false
    default: false       

  ipv4:
    description: "Print data sources for the discovered names"
    required: false
    default: false

  silent:
    description: "Disable all output during execution"
    required: false
    default: false    

  output:
    description: "File to save output result"
    required: false
    default: "amass-result.txt"   




runs:
  using: "composite"
  steps:
    - run: |
        [ ! -x /home/runner/go/bin/gau ] && go install -v github.com/OWASP/Amass/v3/...@master
        [ ! -z ${{ inputs.domain }} ] && echo "domain=-d=${{ inputs.domain}} " >> $GITHUB_ENV
        [ ! -z ${{ inputs.config }} ] && echo "config=-config=${{ inputs.config}} " >> $GITHUB_ENV
        [ ! -z ${{ inputs.brute }} ] && echo "brute=-brute=${{ inputs.brute}} " >> $GITHUB_ENV
        [ ! -z ${{ inputs.src }} ] && echo "src=-src=${{ inputs.src}} " >> $GITHUB_ENV
        [ ! -z ${{ inputs.ipv4 }} ] && echo "ipv4=-ipv4=${{ inputs.ipv4}}  " >> $GITHUB_ENV
        [ ! -z ${{ inputs.silent }} ] && echo "silent=-silent=${{ inputs.silent}} " >> $GITHUB_ENV                                                                 
        [ ! -z ${{ inputs.output }} ] && echo "output=-o=${{ inputs.output}}" >> $GITHUB_ENV      
        echo "/home/runner/go/bin/" >> $GITHUB_PATH
      shell: bash

    - run: |
        /home/runner/go/bin/amass enum \
         ${{ env.domain }} \
         ${{ env.config }} \
         ${{ env.brute }} \
         ${{ env.src }} \
         ${{ env.ipv4 }} \
         ${{ env.output }} 
      shell: bash
